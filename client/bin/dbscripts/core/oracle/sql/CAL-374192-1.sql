alter table  inv_cash_balance rename to inv_cash_balance_back161
;
alter table inv_cash_movement rename to inv_cash_movement_back161
;
alter table inv_sec_balance rename to inv_sec_balance_back161
;
alter table inv_sec_movement rename to inv_sec_movement_back161
;
create table inv_cash_balance(internal_external varchar2(32) not null,
position_type varchar2(32) not null,
agent_id  number not null,
account_id  number not null,
date_type varchar2(32) not null,
position_date timestamp not null,
currency_code varchar2(3) not null,
book_id  number not null,
config_id  number default 0  not null,
mcc_id  number  default 0 not null  ,
sub_account_id  number default 0 not null,
total_amount  decimal(38,15) null,
total_ote_fut  decimal(38,15) null,
total_ote_opt  decimal(38,15) null,
total_ote_disc  decimal(38,15) null,
total_vm_fut  decimal(38,15) null,
total_vm_opt  decimal(38,15) null,
total_vm_disc  decimal(38,15) null,
total_lov  decimal(38,15) null,
total_sov  decimal(38,15) null,
total_commission  decimal(38,15) null,
total_fees  decimal(38,15) null,
total_futures_pl  decimal(38,15) null,
total_option_premium  decimal(38,15) null,
total_option_cash_settlement  decimal(38,15) null,
total_cash_movements  decimal(38,15) null,
version  number not null,
total_margin_call_in decimal(38,15) null,
total_margin_call_out decimal(38,15) null,
total_mc_rehyp_in decimal(38,15) null,
total_mc_rehyp_out decimal(38,15) null,
total_mc_non_rehyp_in decimal(38,15) null,
total_mc_non_rehyp_out decimal(38,15) null,
total_mc_book_owner_in decimal(38,15) null,
total_mc_book_owner_out decimal(38,15) null)
/

insert /*+ parallel(8) */   into inv_cash_balance select  internal_external ,
 position_type  ,
 agent_id  ,
 account_id  ,
 date_type ,
 position_date ,
 currency_code ,
 book_id  ,
config_id ,
 mcc_id ,
 0,
 total_amount as total_amount   ,
 total_ote_fut as total_ote_fut   ,
 total_ote_opt as total_ote_opt   ,
 total_ote_disc as total_ote_disc   ,
 total_vm_fut as total_vm_fut   ,
 total_vm_opt as total_vm_opt   ,
 total_vm_disc as total_vm_disc   , 
 total_lov as total_lov   ,
 total_sov as total_sov   ,
 total_commission as total_commission   ,
 total_fees as total_fees   ,
 total_futures_pl as total_futures_pl   ,
 total_option_premium as total_option_premium   ,
 total_option_cash_settlement as total_option_cash_settlement   ,
 total_cash_movements as total_cash_movements   ,
 version ,
 total_margin_call_in as total_margin_call_in ,
 total_margin_call_out as total_margin_call_out ,
 total_mc_rehyp_in as total_mc_rehyp_in ,
 total_mc_rehyp_out as total_mc_rehyp_out ,
 total_mc_non_rehyp_in as total_mc_non_rehyp_in ,
 total_mc_non_rehyp_out as total_mc_non_rehyp_out ,
 total_mc_book_owner_in as total_mc_book_owner_in ,
 total_mc_book_owner_out as total_mc_book_owner_out from inv_cash_balance_back161
;
create table inv_cash_movement (internal_external varchar2(32) not null,
position_type varchar2(32) not null,
agent_id  number not null,
account_id  number not null,
date_type varchar2(32) not null,
position_date timestamp not null,
currency_code varchar2(3) not null,
book_id  number not null,
config_id  number  default 0  not null,
mcc_id  number default 0 not null  ,
sub_account_id  number default 0 not null,
daily_change  decimal(38,15) null,
daily_ote_fut  decimal(38,15) null,
daily_ote_opt  decimal(38,15) null,
daily_ote_disc  decimal(38,15) null,
daily_vm_fut  decimal(38,15) null,
daily_vm_opt  decimal(38,15) null,
daily_vm_disc  decimal(38,15) null,
daily_lov  decimal(38,15) null,
daily_sov  decimal(38,15) null,
daily_commission  decimal(38,15) null,
daily_fees  decimal(38,15) null,
daily_futures_pl  decimal(38,15) null,
daily_option_premium  decimal(38,15) null,
daily_option_cash_settlement  decimal(38,15) null,
daily_cash_movements  decimal(38,15) null,
version  number not null,
daily_margin_call_in decimal(38,15) null,
daily_margin_call_out decimal(38,15) null,
daily_mc_rehyp_in decimal(38,15) null,
daily_mc_rehyp_out decimal(38,15) null,
daily_mc_non_rehyp_in decimal(38,15) null,
daily_mc_non_rehyp_out decimal(38,15) null,
daily_mc_book_owner_in decimal(38,15) null,
daily_mc_book_owner_out decimal(38,15) null)
/

insert /*+ parallel(8) */  into inv_cash_movement 
select   
 internal_external,
 position_type,
 agent_id ,
 account_id,
 date_type,
 position_date,
 currency_code,
 book_id ,
 config_id, 
 mcc_id ,
 0,
 daily_change as daily_change, 
daily_ote_fut as daily_ote_fut,
daily_ote_opt as daily_ote_opt,
daily_ote_disc as daily_ote_disc, 
daily_vm_fut as daily_vm_fut,
daily_vm_opt as daily_vm_opt,
daily_vm_disc as daily_vm_disc, 
daily_lov as daily_lov,
daily_sov as daily_sov,
daily_commission as daily_commission,
daily_fees as daily_fees,
daily_futures_pl as daily_futures_pl,
daily_option_premium as daily_option_premium,
daily_option_cash_settlement as daily_option_cash_settlement,
daily_cash_movements as daily_cash_movements,
version ,
daily_margin_call_in as daily_margin_call_in,
daily_margin_call_out as daily_margin_call_out,
daily_mc_rehyp_in as daily_mc_rehyp_in,
daily_mc_rehyp_out as daily_mc_rehyp_out,
daily_mc_non_rehyp_in as daily_mc_non_rehyp_in,
daily_mc_non_rehyp_out as daily_mc_non_rehyp_out,
daily_mc_book_owner_in as daily_mc_book_owner_in,
daily_mc_book_owner_out as daily_mc_book_owner_out from inv_cash_movement_back161
/

create table inv_sec_balance (
internal_external  varchar2(32) not null,
        position_type  varchar2(32) not null,
        date_type  varchar2(32) not null,
        agent_id   number not null,
        account_id   number not null,
        position_date  timestamp not null,
        security_id   number not null,
        book_id   number not null,
        config_id   number  default  0  not null,
        mcc_id   number default  0 not null    ,
		sub_account_id  number default 0 not null,
		total_security   decimal(38,15) null,
        total_borrowed   decimal(38,15) null,
        t_bor_not_avl   decimal(38,15) null,
        total_borrowed_ca   decimal(38,15) null,
        total_loaned   decimal(38,15) null,
        t_loan_not_avl   decimal(38,15) null,
        total_loaned_ca   decimal(38,15) null,
        total_coll_in   decimal(38,15) null,
        t_coll_in_not_avl   decimal(38,15) null,
        total_coll_in_ca   decimal(38,15) null,
        total_coll_out   decimal(38,15) null,
        t_coll_out_not_avl   decimal(38,15) null,
        total_coll_out_ca   decimal(38,15) null,
        total_pledged_in   decimal(38,15) null,
        total_pledged_out   decimal(38,15) null,
        total_unavail   decimal(38,15) null,
        total_repo_track_in   decimal(38,15) null,
        total_repo_track_out   decimal(38,15) null,
        total_borrowed_auto   decimal(38,15) null,
        total_loaned_auto   decimal(38,15) null,
        total_pth_in   decimal(38,15) null,
        total_pth_out   decimal(38,15) null,
        total_hold_in   decimal(38,15) null,
        total_hold_out   decimal(38,15) null,
        total_margin_call_in   decimal(38,15) null,
        total_margin_call_out   decimal(38,15) null,
        total_triparty_mc_in   decimal(38,15) null,
        total_triparty_mc_out   decimal(38,15) null,
        total_simple_transfer_in   decimal(38,15) null,
		total_simple_transfer_out   decimal(38,15) null,
        total_repo_callable_in   decimal(38,15) null,
        total_repo_callable_out   decimal(38,15) null,
        total_seclending_callable_in   decimal(38,15) null,
        total_seclending_callable_out   decimal(38,15) null,
        total_margin_call_rehypo   decimal(38,15) null,        
        total_repo_bsb_in   decimal(38,15) null,        
        total_repo_bsb_out   decimal(38,15) null,               
        total_repo_in   decimal(38,15) null,   
        total_repo_out   decimal(38,15) null,          
        version   number not null,
		total_mc_rehyp_in decimal(38,15) null,
		total_mc_rehyp_out decimal(38,15) null,
		total_mc_non_rehyp_in decimal(38,15) null,
		total_mc_non_rehyp_out decimal(38,15) null,
		total_mc_book_owner_in decimal(38,15) null,
		total_mc_book_owner_out decimal(38,15) null)
/

insert /*+ parallel(8) */  into inv_sec_balance  
select 
internal_external,
position_type,
date_type,
agent_id,
account_id,
position_date,
security_id,
book_id,
config_id,
mcc_id,
0,
total_security  as total_security,
total_borrowed  as total_borrowed,
t_bor_not_avl  as t_bor_not_avl,
total_borrowed_ca  as total_borrowed_ca,
total_loaned  as total_loaned,
t_loan_not_avl  as t_loan_not_avl,
total_loaned_ca  as total_loaned_ca,
total_coll_in  as total_coll_in,
t_coll_in_not_avl  as t_coll_in_not_avl,
total_coll_in_ca  as total_coll_in_ca,
total_coll_out  as total_coll_out,
t_coll_out_not_avl  as t_coll_out_not_avl,
total_coll_out_ca  as total_coll_out_ca,
total_pledged_in  as total_pledged_in,
total_pledged_out  as total_pledged_out,
total_unavail  as total_unavail,
total_repo_track_in  as total_repo_track_in,
total_repo_track_out  as total_repo_track_out,
total_borrowed_auto  as total_borrowed_auto,
total_loaned_auto  as total_loaned_auto,
total_pth_in  as total_pth_in,
total_pth_out  as total_pth_out,
total_hold_in  as total_hold_in,
total_hold_out  as total_hold_out,
total_margin_call_in  as total_margin_call_in,
total_margin_call_out  as total_margin_call_out,
total_triparty_mc_in  as total_triparty_mc_in,
total_triparty_mc_out  as total_triparty_mc_out,
total_simple_transfer_in  as total_simple_transfer_in,
total_simple_transfer_out  as total_simple_transfer_out,
total_repo_callable_in  as total_repo_callable_in,
total_repo_callable_out  as total_repo_callable_out,
total_seclending_callable_in  as total_seclending_callable_in,
total_seclending_callable_out as total_seclending_callable_out,
total_margin_call_rehypo  as total_margin_call_rehypo,
total_repo_bsb_in  as total_repo_bsb_in,
total_repo_bsb_out  as total_repo_bsb_out,
total_repo_in  as total_repo_in,
total_repo_out  as total_repo_out ,
version ,
total_mc_rehyp_in as total_mc_rehyp_in,
total_mc_rehyp_out as total_mc_rehyp_out,
total_mc_non_rehyp_in as total_mc_non_rehyp_in,
total_mc_non_rehyp_out  as total_mc_non_rehyp_out,
total_mc_book_owner_in as total_mc_book_owner_in,
total_mc_book_owner_out as total_mc_book_owner_out from inv_sec_balance_back161
;

create table inv_sec_movement (
        internal_external varchar2(32) not null,
        position_type varchar2(32) not null,
        date_type varchar2(32) not null,
        agent_id  number not null,
        account_id  number not null,
        position_date timestamp not null,
        security_id  number not null,
        book_id  number not null,
        config_id  number default 0 not null,
        mcc_id  number default 0  not null ,
		sub_account_id  number default 0 not null,
		daily_security  decimal(38,15) null,
        daily_borrowed  decimal(38,15) null,
        d_bor_not_avl  decimal(38,15) null,
        daily_borrowed_ca  decimal(38,15) null,
        daily_loaned  decimal(38,15) null,
        d_loan_not_avl  decimal(38,15) null,
        daily_loaned_ca  decimal(38,15) null,
        daily_coll_in  decimal(38,15) null,
        d_coll_in_not_avl  decimal(38,15) null,
        daily_coll_in_ca  decimal(38,15) null,
        daily_coll_out  decimal(38,15) null,
        d_coll_out_not_avl  decimal(38,15) null,
        daily_coll_out_ca  decimal(38,15) null,
        daily_pledged_in  decimal(38,15) null,
        daily_pledged_out  decimal(38,15) null,
        daily_unavail  decimal(38,15) null,
        daily_repo_track_in  decimal(38,15) null,
        daily_repo_track_out  decimal(38,15) null,
        daily_borrowed_auto  decimal(38,15) null,
        daily_loaned_auto  decimal(38,15) null,
        daily_pth_in  decimal(38,15) null,
        daily_pth_out  decimal(38,15) null,
		daily_hold_in  decimal(38,15) null,
        daily_hold_out  decimal(38,15) null,
        daily_margin_call_in  decimal(38,15) null,
		daily_margin_call_out  decimal(38,15) null,
		daily_triparty_mc_in  decimal(38,15) null,
		daily_triparty_mc_out  decimal(38,15) null,
		daily_simple_transfer_in  decimal(38,15) null,
		daily_simple_transfer_out  decimal(38,15) null,
        daily_repo_callable_in  decimal(38,15) null,
		daily_repo_callable_out  decimal(38,15) null,
		daily_seclending_callable_in  decimal(38,15) null,
		daily_seclending_callable_out  decimal(38,15) null,
		daily_margin_call_rehypo  decimal(38,15) null,
		daily_repo_bsb_in  decimal(38,15) null,        
        daily_repo_bsb_out  decimal(38,15) null, 
        daily_repo_in  decimal(38,15) null,   
        daily_repo_out  decimal(38,15) null,      
        version  number not null,
		daily_mc_rehyp_in decimal(38,15) null, 
		daily_mc_rehyp_out decimal(38,15) null, 
		daily_mc_non_rehyp_in decimal(38,15) null, 
		daily_mc_non_rehyp_out decimal(38,15) null, 
		daily_mc_book_owner_in decimal(38,15) null, 
		daily_mc_book_owner_out decimal(38,15) null)
/
			
insert /*+ parallel(8) */  into  inv_sec_movement  select  
internal_external,
position_type,
date_type,
agent_id,
account_id,
position_date,
security_id,
book_id,
config_id,
mcc_id,
0,
daily_security  as daily_security,
daily_borrowed  as daily_borrowed,
d_bor_not_avl  as d_bor_not_avl,
daily_borrowed_ca  as daily_borrowed_ca,
daily_loaned  as daily_loaned,
d_loan_not_avl  as d_loan_not_avl,
daily_loaned_ca  as daily_loaned_ca,
daily_coll_in  as daily_coll_in,
d_coll_in_not_avl  as d_coll_in_not_avl,
daily_coll_in_ca  as daily_coll_in_ca,
daily_coll_out  as daily_coll_out,
d_coll_out_not_avl  as d_coll_out_not_avl,
daily_coll_out_ca  as daily_coll_out_ca,
daily_pledged_in  as daily_pledged_in,
daily_pledged_out  as daily_pledged_out,
daily_unavail  as daily_unavail,
daily_repo_track_in  as daily_repo_track_in,
daily_repo_track_out  as daily_repo_track_out,
daily_borrowed_auto  as daily_borrowed_auto,
daily_loaned_auto  as daily_loaned_auto,
daily_pth_in  as daily_pth_in,
daily_pth_out  as daily_pth_out,
daily_hold_in  as daily_hold_in,
daily_hold_out  as daily_hold_out,
daily_margin_call_in  as daily_margin_call_in,
daily_margin_call_out  as daily_margin_call_out,
daily_triparty_mc_in  as daily_triparty_mc_in,
daily_triparty_mc_out  as daily_triparty_mc_out,
daily_simple_transfer_in  as daily_simple_transfer_in,
daily_simple_transfer_out  as daily_simple_transfer_out,
daily_repo_callable_in  as daily_repo_callable_in,
daily_repo_callable_out  as daily_repo_callable_out,
daily_seclending_callable_in as daily_seclending_callable_in,
daily_seclending_callable_out as daily_seclending_callable_out,
daily_margin_call_rehypo  as daily_margin_call_rehypo,
daily_repo_bsb_in  as daily_repo_bsb_in,
daily_repo_bsb_out  as daily_repo_bsb_out,
daily_repo_in  as daily_repo_in,
daily_repo_out  as daily_repo_out,
version ,
daily_mc_rehyp_in as daily_mc_rehyp_in, 
daily_mc_rehyp_out as daily_mc_rehyp_out,
daily_mc_non_rehyp_in as daily_mc_non_rehyp_in, 
daily_mc_non_rehyp_out as daily_mc_non_rehyp_out,
daily_mc_book_owner_in as daily_mc_book_owner_in,
daily_mc_book_owner_out as daily_mc_book_owner_out from inv_sec_movement_back161
/

alter table inv_sec_movement noparallel logging
/

alter table inv_sec_balance noparallel logging
/

alter table inv_cash_movement noparallel logging
/

alter table inv_cash_balance noparallel logging
/


drop table inv_cash_balance_back161
/

drop table inv_cash_movement_back161
/

drop table inv_sec_balance_back161
/

drop table inv_sec_movement_back161
/